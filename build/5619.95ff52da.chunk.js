"use strict";(self.webpackChunknassif_group_strapi=self.webpackChunknassif_group_strapi||[]).push([[5619],{12038:(G,g,s)=>{s.d(g,{u:()=>l});var t=s(21272),e=s(56445),d=s(54894),r=s(74930);const l=(p={},W={})=>{const{id:A="",...L}=p,{get:_}=(0,e.ry)(),{locale:f}=(0,d.A)(),C=(0,e.QM)(f,{sensitivity:"base"}),{data:R,error:Q,isError:V,isLoading:z,refetch:y}=(0,r.useQuery)(["roles",A,L],async()=>{const{data:u}=await _(`/admin/roles/${A??""}`,{params:L});return u},W);return{roles:t.useMemo(()=>{let u=[];return R&&(Array.isArray(R.data)?u=R.data:u=[R.data]),[...u].sort((m,X)=>C.compare(m.name,X.name))},[R,C]),error:Q,isError:V,isLoading:z,refetch:y}}},40216:(G,g,s)=>{s.d(g,{S:()=>L});var t=s(92132),e=s(94929),d=s(94061),r=s(48653),l=s(83997),p=s(30893);const W=(0,e.Ay)(d.a)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:_})=>_.colors.primary600};
  }
`,A=(0,e.Ay)(d.a)`
  border-radius: 0 0 ${({theme:_})=>_.borderRadius} ${({theme:_})=>_.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,L=({children:_,icon:f,...C})=>(0,t.jsxs)("div",{children:[(0,t.jsx)(r.c,{}),(0,t.jsx)(A,{as:"button",background:"primary100",padding:5,...C,children:(0,t.jsxs)(l.s,{children:[(0,t.jsx)(W,{"aria-hidden":!0,background:"primary200",children:f}),(0,t.jsx)(d.a,{paddingLeft:3,children:(0,t.jsx)(p.o,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:_})})]})})]})},58e3:(G,g,s)=>{s.r(g),s.d(g,{default:()=>rs});var t=s(92132),e=s(56445),d=s(82437),r=s(97927),l=s(21272),p=s(94061),W=s(85963),A=s(88353),L=s(74773),_=s(4198),f=s(55356),C=s(38413),R=s(83997),Q=s(35513),V=s(25641),z=s(26127),y=s(90361),E=s(33363),u=s(40216),m=s(30893),X=s(98765),q=s(90625),ss=s(41909),w=s(5194),ts=s(50612),H=s(54894),es=s(17703),ns=s(12038),T=s(33544),as=s(88761),Ds=s(74930),Ms=s(55151),cs=s(79077),Os=s(59057),Ps=s(15126),gs=s(63299),ms=s(67014),hs=s(59080),Cs=s(79275),Rs=s(14718),us=s(61535),Ts=s(5790),As=s(12083),Ls=s(41286),xs=s(35223),vs=s(5409),Bs=s(2600),Is=s(48940),js=s(51187);const os=()=>"todo empty role",J=({id:a,name:D,description:o,usersCount:x,icons:i,rowIndex:U,canUpdate:M})=>{const{formatMessage:v}=(0,H.A)(),[,B]=i,c=v({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:x});return(0,t.jsxs)(y.Tr,{"aria-rowindex":U,...M?(0,e.qM)({fn:B.onClick}):{},children:[(0,t.jsx)(E.Td,{maxWidth:(0,e.a8)(130),children:(0,t.jsx)(m.o,{ellipsis:!0,textColor:"neutral800",children:D})}),(0,t.jsx)(E.Td,{maxWidth:(0,e.a8)(250),children:(0,t.jsx)(m.o,{ellipsis:!0,textColor:"neutral800",children:o})}),(0,t.jsx)(E.Td,{children:(0,t.jsx)(m.o,{textColor:"neutral800",children:c})}),(0,t.jsx)(E.Td,{children:(0,t.jsx)(R.s,{justifyContent:"flex-end",...e.dG,children:i.map((O,I)=>O?(0,t.jsx)(p.a,{paddingLeft:I===0?0:1,children:(0,t.jsx)(A.K,{onClick:O.onClick,label:O.label,noBorder:!0,icon:O.icon})},O.label):null)})})]},a)};J.propTypes={id:T.number.isRequired,name:T.string.isRequired,description:T.string.isRequired,usersCount:T.number.isRequired,icons:T.array.isRequired,rowIndex:T.number.isRequired,canUpdate:T.bool},J.defaultProps={canUpdate:!1};const ls={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},_s=(a,D)=>(0,as.Ay)(a,o=>{switch(D.type){case"ON_REMOVE_ROLES":{o.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{o.shouldRefetchData=!0,o.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{o.shouldRefetchData=!1,o.roleToDelete=null,o.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{o.roleToDelete=D.id;break}default:return o}}),is=({canCreate:a,canDelete:D,canUpdate:o,refetchRoles:x})=>{const{formatMessage:i}=(0,H.A)(),{formatAPIError:U}=(0,e.wq)(),M=(0,e.hN)(),[v,B]=(0,l.useState)(!1),{push:c}=(0,es.W6)(),[{selectedRoles:O,showModalConfirmButtonLoading:I,roleToDelete:Y},K]=(0,l.useReducer)(_s,ls),{post:Z}=(0,e.GD)(),b=async()=>{try{K({type:"ON_REMOVE_ROLES"}),await Z("/admin/roles/batch-delete",{ids:[Y]}),await x(),K({type:"RESET_DATA_TO_DELETE"})}catch(n){M({type:"warning",message:U(n)})}j()},$=(0,l.useCallback)(n=>{c(`/settings/roles/duplicate/${n}`)},[c]),S=()=>c("/settings/roles/new"),N=(0,l.useCallback)(n=>{K({type:"SET_ROLE_TO_DELETE",id:n}),j()},[]),j=()=>B(n=>!n),P=(0,l.useCallback)(n=>{c(`/settings/roles/${n}`)},[c]),F=(0,l.useCallback)((n,h)=>{n.preventDefault(),n.stopPropagation(),h.usersCount?M({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):N(h.id)},[M,N]),k=(0,l.useCallback)((n,h)=>{n.preventDefault(),n.stopPropagation(),$(h.id)},[$]),Es=(0,l.useCallback)(n=>[...a?[{onClick:h=>k(h,n),label:i({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:(0,t.jsx)(q.A,{})}]:[],...o?[{onClick:()=>P(n.id),label:i({id:"app.utils.edit",defaultMessage:"Edit"}),icon:(0,t.jsx)(ss.A,{})}]:[],...D?[{onClick:h=>F(h,n),label:i({id:"global.delete",defaultMessage:"Delete"}),icon:(0,t.jsx)(ts.A,{})}]:[]],[i,F,k,P,a,o,D]);return{handleNewRoleClick:S,getIcons:Es,selectedRoles:O,isWarningDeleteAllOpened:v,showModalConfirmButtonLoading:I,handleToggleModal:j,handleDeleteData:b}},ds=()=>{const{formatMessage:a}=(0,H.A)();(0,e.L4)();const D=(0,d.d4)(r.s),[{query:o}]=(0,e.sq)(),{isLoading:x,allowedActions:{canCreate:i,canDelete:U,canRead:M,canUpdate:v}}=(0,e.ec)(D.settings.roles),{roles:B,isLoading:c,refetch:O}=(0,ns.u)({filters:o?._q?{name:{$containsi:o._q}}:void 0},{cacheTime:0,enabled:!x&&M}),{handleNewRoleClick:I,getIcons:Y,isWarningDeleteAllOpened:K,showModalConfirmButtonLoading:Z,handleToggleModal:b,handleDeleteData:$}=is({refetchRoles:O,canCreate:i,canDelete:U,canUpdate:v}),S=B.length+1,N=6;if(x)return(0,t.jsx)(C.g,{children:(0,t.jsx)(e.Bl,{})});const j=a({id:"global.roles",defaultMessage:"roles"});return(0,t.jsxs)(C.g,{children:[(0,t.jsx)(e.x7,{name:"Roles"}),(0,t.jsx)(f.Q,{primaryAction:i?(0,t.jsx)(W.$,{onClick:I,startIcon:(0,t.jsx)(w.A,{}),size:"S",children:a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,title:j,subtitle:a({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),M&&(0,t.jsx)(L.B,{startActions:(0,t.jsx)(e.q7,{label:a({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:j})})}),M&&(0,t.jsxs)(_.s,{children:[(0,t.jsxs)(Q.X,{colCount:N,rowCount:S,footer:i?(0,t.jsx)(u.S,{onClick:I,icon:(0,t.jsx)(w.A,{}),children:a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,children:[(0,t.jsx)(z.d,{children:(0,t.jsxs)(y.Tr,{"aria-rowindex":1,children:[(0,t.jsx)(E.Th,{children:(0,t.jsx)(m.o,{variant:"sigma",textColor:"neutral600",children:a({id:"global.name",defaultMessage:"Name"})})}),(0,t.jsx)(E.Th,{children:(0,t.jsx)(m.o,{variant:"sigma",textColor:"neutral600",children:a({id:"global.description",defaultMessage:"Description"})})}),(0,t.jsx)(E.Th,{children:(0,t.jsx)(m.o,{variant:"sigma",textColor:"neutral600",children:a({id:"global.users",defaultMessage:"Users"})})}),(0,t.jsx)(E.Th,{children:(0,t.jsx)(X.s,{children:a({id:"global.actions",defaultMessage:"Actions"})})})]})}),(0,t.jsx)(V.N,{children:B?.map((P,F)=>(0,t.jsx)(J,{id:P.id,name:P.name,description:P.description,usersCount:P.usersCount,icons:Y(P),rowIndex:F+2,canUpdate:v},P.id))})]}),!S&&!c&&(0,t.jsx)(os,{})]}),(0,t.jsx)(e.TM,{isOpen:K,onConfirm:$,isConfirmButtonLoading:Z,onToggleDialog:b})]})},rs=()=>{const a=(0,d.d4)(r.s);return(0,t.jsx)(e.kz,{permissions:a.settings.roles.main,children:(0,t.jsx)(ds,{})})}},74773:(G,g,s)=>{s.d(g,{B:()=>d});var t=s(92132),e=s(83997);const d=({startActions:r,endActions:l})=>!r&&!l?null:(0,t.jsxs)(e.s,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,t.jsx)(e.s,{gap:2,wrap:"wrap",children:r}),(0,t.jsx)(e.s,{gap:2,shrink:0,wrap:"wrap",children:l})]})}}]);
