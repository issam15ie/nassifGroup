"use strict";(self.webpackChunknassif_group_strapi=self.webpackChunknassif_group_strapi||[]).push([[4904],{4904:(F,v,s)=>{s.r(v),s.d(v,{InformationBoxEE:()=>ss});var t=s(92132),a=s(56445),D=s(46715),x=s(76517),C=s(80782),L=s(7153),W=s(16918),c=s(10229),u=s(43064),T=s(83997),Y=s(48323),H=s(30893),G=s(54894),S=s(74930),Q=s(82437),ts=s(51187),as=s(2600),ns=s(35223),os=s(54257),es=s(86781),_s=s(59080),ls=s(48940),Z=s(8589),J=s(97927),o=s(28091),N=s(21272),X=s(89031),h=s(63072),K=s(80909),z=s(40145),Es=s(45635),rs=s(14718),is=s(75866),ds=s(57505),Ms=s(5409),Ds=s(56336),Os=s(39404),Ps=s(59057),gs=s(15126),ms=s(63299),vs=s(67014),Cs=s(79275),cs=s(61535),hs=s(5790),As=s(12083),Is=s(41286),Ls=s(14311),Ws=s(501),Ts=s(55003),Bs=s(57646),Rs=s(23120),fs=s(44414),Us=s(25962),us=s(14664),Ks=s(42588),ys=s(90325),js=s(62785),xs=s(87443),Ss=s(41032),Ns=s(22957),ps=s(93179),$s=s(15747),ws=s(89102),Fs=s(85306),Ys=s(77965),Gs=s(26509),zs=s(32058),Vs=s(81185),Hs=s(82261),Qs=s(14303),Zs=s(71547),Js=s(16819),Xs=s(94710),ks=s(84624),bs=s(71210),qs=s(55151),st=s(79077);function k(){const{initialData:_,layout:{uid:r},isSingleType:O,onChange:B}=(0,a.Cu)(),R=(0,Q.d4)(J.s),{formatMessage:n}=(0,G.A)(),{formatAPIError:f}=(0,a.wq)(),d=(0,a.hN)(),{put:U}=(0,a.ry)(),{allowedActions:{canReadUsers:i},isLoading:P}=(0,a.ec)({readUsers:R.settings.users.read}),{users:A,isLoading:I,isError:y}=(0,Z.u)({},{enabled:!P&&i}),g=_?.[o.A]??null,m=async({value:e})=>{l.mutate({entityId:_.id,assigneeId:parseInt(e,10),uid:r})},l=(0,S.useMutation)(async({entityId:e,assigneeId:p,uid:$})=>{const E=O?"single-types":"collection-types",{data:{data:M}}=await U(`/admin/content-manager/${E}/${$}/${e}/assignee`,{data:{id:p}});return B({target:{name:o.A,value:M[o.A]}},!0),M},{onSuccess(){d({type:"success",message:{id:"content-manager.reviewWorkflows.assignee.notification.saved",defaultMessage:"Assignee updated"}})}});return(0,t.jsx)(L.D,{name:o.A,id:o.A,children:(0,t.jsx)(T.s,{direction:"column",gap:2,alignItems:"stretch",children:(0,t.jsx)(x.G3,{clearLabel:n({id:"content-manager.reviewWorkflows.assignee.clear",defaultMessage:"Clear assignee"}),error:y&&i&&n({id:"content-manager.reviewWorkflows.assignee.error",defaultMessage:"An error occurred while fetching users"})||l.error&&f(l.error),disabled:!P&&!I&&A.length===0,name:o.A,id:o.A,value:g?g.id:null,onChange:e=>m({value:e}),onClear:()=>m({value:null}),placeholder:n({id:"content-manager.reviewWorkflows.assignee.placeholder",defaultMessage:"Select \u2026"}),label:n({id:"content-manager.reviewWorkflows.assignee.label",defaultMessage:"Assignee"}),loading:I||P||l.isLoading,children:A.map(e=>(0,t.jsx)(C.j,{value:e.id,textValue:(0,D.g)(e,n),children:(0,D.g)(e,n)},e.id))})})})}function b({id:_,layout:r}={},O={}){const{kind:B,uid:R}=r,n=B==="collectionType"?"collection-types":"single-types",{get:f}=(0,a.ry)(),{data:d,isLoading:U,refetch:i}=(0,S.useQuery)(["content-manager",n,r.uid,_,"stages"],async()=>{const{data:I}=await f(`/admin/content-manager/${n}/${R}/${_}/stages`);return I},O),P=N.useMemo(()=>d?.meta??{},[d?.meta]),A=N.useMemo(()=>d?.data??[],[d?.data]);return{meta:P,stages:A,isLoading:U,refetch:i}}function q(){const{initialData:_,layout:r,isSingleType:O,onChange:B}=(0,a.Cu)(),{put:R}=(0,a.ry)(),{formatMessage:n}=(0,G.A)(),{formatAPIError:f}=(0,a.wq)(),d=(0,a.hN)(),{meta:U,stages:i,isLoading:P,refetch:A}=b({id:_.id,layout:r},{enabled:!!_?.id}),{getFeature:I}=(0,X.u)(),[y,g]=N.useState(!1),m=I("review-workflows"),l=_?.[o.S]??null,e=(0,S.useMutation)(async({entityId:E,stageId:M,uid:j})=>{const w=O?"single-types":"collection-types",{data:{data:V}}=await R(`/admin/content-manager/${w}/${j}/${E}/stage`,{data:{id:M}});return B({target:{name:o.S,value:V[o.S]}},!0),await A(),V},{onSuccess(){d({type:"success",message:{id:"content-manager.reviewWorkflows.stage.notification.saved",defaultMessage:"Review stage updated"}})}}),p=async({value:E})=>{try{m?.[K.C]&&parseInt(m[K.C],10)<U.workflowCount?g("workflow"):m?.[K.a]&&parseInt(m[K.a],10)<i.length?g("stage"):e.mutateAsync({entityId:_.id,stageId:E,uid:r.uid})}catch{}},{themeColorName:$}=l?.color?(0,z.g)(l?.color):{};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.D,{hint:i.length===0&&n({id:"content-manager.reviewWorkflows.stages.no-transition",defaultMessage:"You don\u2019t have the permission to update this stage."}),name:o.S,id:o.S,children:(0,t.jsxs)(T.s,{direction:"column",gap:2,alignItems:"stretch",children:[(0,t.jsx)(Y.Z,{disabled:i.length===0,error:e.error&&f(e.error)||null,name:o.S,id:o.S,value:l?.id,onChange:E=>p({value:E}),label:n({id:"content-manager.reviewWorkflows.stage.label",defaultMessage:"Review stage"}),startIcon:l&&(0,t.jsx)(T.s,{as:"span",height:2,background:l?.color,borderColor:$==="neutral0"?"neutral150":"transparent",hasRadius:!0,shrink:0,width:2,marginRight:"-3px"}),customizeContent:()=>(0,t.jsxs)(T.s,{as:"span",justifyContent:"space-between",alignItems:"center",width:"100%",children:[(0,t.jsx)(H.o,{textColor:"neutral800",ellipsis:!0,children:l?.name??""}),P?(0,t.jsx)(u.a,{small:!0,style:{display:"flex"},"data-testid":"loader"}):null]}),children:i.map(({id:E,color:M,name:j})=>{const{themeColorName:w}=(0,z.g)(M);return(0,t.jsx)(Y.eY,{startIcon:(0,t.jsx)(T.s,{height:2,background:M,borderColor:w==="neutral0"?"neutral150":"transparent",hasRadius:!0,shrink:0,width:2}),value:E,textValue:j,children:j},E)})}),(0,t.jsx)(W.o,{}),(0,t.jsx)(c.b,{})]})}),(0,t.jsxs)(h.L,{isOpen:y==="workflow",onClose:()=>g(!1),children:[(0,t.jsx)(h.T,{children:n({id:"content-manager.reviewWorkflows.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})}),(0,t.jsx)(h.B,{children:n({id:"content-manager.reviewWorkflows.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})})]}),(0,t.jsxs)(h.L,{isOpen:y==="stage",onClose:()=>g(!1),children:[(0,t.jsx)(h.T,{children:n({id:"content-manager.reviewWorkflows.stages.limit.title",defaultMessage:"You have reached the limit of stages for this workflow in your plan"})}),(0,t.jsx)(h.B,{children:n({id:"content-manager.reviewWorkflows.stages.limit.body",defaultMessage:"Try deleting some stages or contact Sales to enable more stages."})})]})]})}function ss(){const{isCreatingEntry:_,layout:{options:r}}=(0,a.Cu)(),O=r?.reviewWorkflows??!1;return(0,t.jsxs)(D.I.Root,{children:[(0,t.jsx)(D.I.Title,{}),O&&!_&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q,{}),(0,t.jsx)(k,{})]}),(0,t.jsx)(D.I.Body,{})]})}},28091:(F,v,s)=>{s.d(v,{A:()=>a,S:()=>t});const t="strapi_stage",a="strapi_assignee"},40145:(F,v,s)=>{s.d(v,{a:()=>x,g:()=>D});var t=s(57438),a=s(80909);function D(C){if(!C)return null;const W=Object.entries(t._.colors).filter(([,c])=>c.toUpperCase()===C.toUpperCase()).reduce((c,[u])=>(a.S?.[u]&&(c=u),c),null);return W?{themeColorName:W,name:a.S[W]}:null}function x(){return Object.entries(a.S).map(([C,L])=>({hex:t._.colors[C].toUpperCase(),name:L}))}}}]);
